@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<http://worldhealthorganization.github.io/ddcc/StructureMap/ResourcesToCoreDataSet> a fhir:StructureMap;
  fhir:nodeRole fhir:treeRoot;
  fhir:Resource.id [ fhir:value "ResourcesToCoreDataSet"];
  fhir:Resource.meta [
     fhir:Meta.versionId [ fhir:value "1" ];
     fhir:Meta.lastUpdated [ fhir:value "2021-12-21T20:57:05.702+00:00"^^xsd:dateTime ]
  ];
  fhir:DomainResource.text [
     fhir:Narrative.status [ fhir:value "generated" ];
     fhir:Narrative.div "<div xmlns=\"http://www.w3.org/1999/xhtml\"><pre>map &quot;http://worldhealthorganization.github.io/ddcc/StructureMap/ResourcesToCoreDataSet&quot; = &quot;ResourcesToCoreDataSet&quot;\r\n\r\n\r\nuses &quot;http://hl7.org/fhir/StructureDefinition/Bundle&quot; alias Bundle as source\r\nuses &quot;http://hl7.org/fhir/StructureDefinition/HumanName&quot; alias HumanName as produced\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCPatient&quot; alias DDCCPatient as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunization&quot; alias DDCCImmunization as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunizationRecommendation&quot; alias DDCCImmunizationRecommendation as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCComposition&quot; alias DDCCComposition as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCoreDataSet.VS.PoV&quot; alias DDCCPoV as target\r\n\r\ngroup ResourcesToCoreDataSet(source bundle : Bundle, target ddcc : DDCCPoV) {\r\n  bundle -&gt;  ddcc.vaccination as vaccination,  ddcc.certificate as certificate then {\r\n    bundle.link first as link -&gt; certificate.hcid as hcid then {\r\n      // There's got to be a better way to do this\r\n      link.url as url -&gt; hcid.value = (url.replaceMatches('[Uu][Rr][Nn]:[Hh][Cc][Ii][Dd]:', '')) &quot;set hcid value&quot;;\r\n    } &quot;set hcid&quot;;\r\n    bundle.id as id -&gt;  certificate.ddccid as ddccid,  ddccid.value = id &quot;set ddcc id value&quot;;\r\n    bundle.entry as entry then {\r\n      entry.resource : Patient first as patient then PatientToDDCCVS(patient, ddcc) &quot;set patient details&quot;;\r\n      entry.resource : Immunization first as immunization then ImmunizationToDDCCVS(immunization, vaccination, certificate) &quot;set immunization&quot;;\r\n      entry.resource : ImmunizationRecommendation first as immRec then ImmRecToDDCCVS(immRec, vaccination) &quot;set immunization recommendation&quot;;\r\n      entry.resource : Composition first as composition then CompositionToDDCCVS(composition, certificate) &quot;set composition&quot;;\r\n    } &quot;set header from patient&quot;;\r\n  } &quot;setup ddcc&quot;;\r\n}\r\n\r\ngroup CompositionToDDCCVS(source composition : DDCCComposition, target certificate) {\r\n  composition -&gt; certificate.version = 'RC2' &quot;set version&quot;;\r\n  composition.event first as event then {\r\n    event.period as period -&gt; certificate.period as tPeriod then {\r\n      period.start as start -&gt; tPeriod.start = start &quot;set period start&quot;;\r\n      period.end as end -&gt; tPeriod.end = end &quot;set period end&quot;;\r\n    } &quot;set period&quot;;\r\n  } &quot;set certificate period&quot;;\r\n}\r\n\r\ngroup PatientToDDCCVS(source patient : DDCCPatient, target ddcc : DDCCPoV) {\r\n  patient.name as name then NameToText(name, ddcc) &quot;set name&quot;;\r\n  patient.birthDate as bday -&gt; ddcc.birthDate = bday &quot;set birth date&quot;;\r\n  patient.id as id -&gt;  ddcc.identifier as identifier,  identifier.value = id &quot;set identifier from id&quot;;\r\n  // this will override what was set from id if it exists\r\n  patient.identifier first as sId -&gt; ddcc.identifier as identifier then {\r\n    sId.value as id -&gt; identifier.value = id &quot;set identifier value&quot;;\r\n  } &quot;set identifier from identifier&quot;;\r\n  patient.gender as gender -&gt; ddcc.sex = gender &quot;set sex&quot;;\r\n}\r\n\r\ngroup NameToText(source name : HumanName, target ddcc) {\r\n  // annoying because append doesn't work until ddcc.name is set\r\n  name.given first as given -&gt; ddcc.name = (given.replaceMatches('$', ' ')) &quot;set first name&quot;;\r\n  // name.given not_first as other -&gt; ddcc.name as tName, ddcc.name = append( tName, other ) &quot;set other names&quot;;\r\n  name.given not_first as other -&gt;  ddcc.name as tName,  (other.replaceMatches('$', ' ')) as spaced,  ddcc.name = append(tName, spaced) &quot;set other names&quot;;\r\n  name.family as family -&gt;  ddcc.name as tName,  ddcc.name = append(tName, family) &quot;add family name&quot;;\r\n  name.text as text -&gt; ddcc.name = text &quot;set full name&quot;;\r\n}\r\n\r\ngroup ImmunizationToDDCCVS(source immunization : DDCCImmunization, target vaccination, target certificate) {\r\n  immunization.vaccineCode as code then {\r\n    code.coding first as coding -&gt; vaccination.vaccine = coding &quot;set vaccine&quot;;\r\n  } &quot;set vaccine code&quot;;\r\n  immunization.extension as ext then {\r\n    ext first as brand where ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineBrand' then {\r\n      brand.valueCoding as coding -&gt; vaccination.brand = coding &quot;set brand code&quot;;\r\n    } &quot;set brand&quot;;\r\n    ext first as maholder where ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineMarketAuthorization' then {\r\n      maholder.valueCoding as coding -&gt; vaccination.maholder = coding &quot;set maholder code&quot;;\r\n    } &quot;set maholder&quot;;\r\n    ext first as valid where ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineValidFrom' then {\r\n      valid.valueDateTime as date -&gt; vaccination.validFrom = date &quot;set validFrom date&quot;;\r\n    } &quot;set validFrom&quot;;\r\n    ext first as country where ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCountryOfVaccination' then {\r\n      country.valueCode as code -&gt;  vaccination.country as vCountry,  vCountry.system = 'urn:iso:std:iso:3166',  vCountry.code = code &quot;set country code&quot;;\r\n    } &quot;set country&quot;;\r\n  } &quot;set extensions&quot;;\r\n  immunization.manufacturer as manufacturer then {\r\n    manufacturer.identifier as identifier -&gt; vaccination.manufacturer as vMan then {\r\n      identifier.system as system -&gt; vMan.system = system &quot;set manufacturer system&quot;;\r\n      identifier.value as value -&gt; vMan.code = value &quot;set manufactutuer code&quot;;\r\n    } &quot;set manufacturer id&quot;;\r\n  } &quot;set manufacturer&quot;;\r\n  immunization.lotNumber as lot -&gt; vaccination.lot = lot &quot;set lot number&quot;;\r\n  immunization.occurrence as date -&gt; vaccination.date = date &quot;set date&quot;;\r\n  immunization.protocolApplied first as protocol then {\r\n    protocol.doseNumber as dose -&gt; vaccination.dose = dose &quot;set dose&quot;;\r\n    protocol.seriesDoses as totalDoses -&gt; vaccination.totalDoses = totalDoses &quot;set totalDoses&quot;;\r\n    protocol.targetDisease first as disease then {\r\n      disease.coding first as coding -&gt; vaccination.disease = coding &quot;set disease coding&quot;;\r\n    } &quot;set disease&quot;;\r\n    protocol.authority as authority -&gt; certificate.issuer as issuer then {\r\n      authority.reference as reference -&gt; issuer.identifier as identifier then {\r\n        reference -&gt; identifier.value = reference &quot;set reference&quot;;\r\n      } &quot;set issuer from reference&quot;;\r\n      authority.identifier as identifier -&gt; issuer.identifier = identifier &quot;set issuer identifier&quot;;\r\n    } &quot;set issuer&quot;;\r\n  } &quot;set protocol applied&quot;;\r\n  immunization.location as location then {\r\n    location.reference as reference -&gt; vaccination.centre = reference &quot;set vaccination centre from reference&quot;;\r\n    location.display as centre -&gt; vaccination.centre = centre &quot;set vaccination centre&quot;;\r\n  } &quot;set vaccination centre location&quot;;\r\n  immunization.performer first as performer then {\r\n    performer.actor as actor then {\r\n      actor.identifier as identifier -&gt; vaccination.practitioner = identifier &quot;set practitioner&quot;;\r\n    } &quot;set actor&quot;;\r\n  } &quot;set performer&quot;;\r\n}\r\n\r\ngroup ImmRecToDDCCVS(source immRec : DDCCImmunizationRecommendation, target vaccination) {\r\n  immRec.recommendation as rec then {\r\n    rec.dateCriterion first as due_date then {\r\n      due_date.value as date -&gt; vaccination.nextDose = date &quot;set due date&quot;;\r\n    } &quot;get date criterion&quot;;\r\n  } &quot;get recommendation&quot;;\r\n}\r\n\r\n</pre></div>"
  ];
  fhir:StructureMap.url [ fhir:value "http://worldhealthorganization.github.io/ddcc/StructureMap/ResourcesToCoreDataSet"];
  fhir:StructureMap.version [ fhir:value "0.3.1"];
  fhir:StructureMap.name [ fhir:value "ResourcesToCoreDataSet"];
  fhir:StructureMap.status [ fhir:value "draft"];
  fhir:StructureMap.date [ fhir:value "2022-01-25T14:32:12+00:00"^^xsd:dateTime];
  fhir:StructureMap.publisher [ fhir:value "WHO"];
  fhir:StructureMap.contact [
     fhir:index 0;
     fhir:ContactDetail.name [ fhir:value "WHO" ];
     fhir:ContactDetail.telecom [
       fhir:index 0;
       fhir:ContactPoint.system [ fhir:value "url" ];
       fhir:ContactPoint.value [ fhir:value "http://who.int" ]
     ]
  ];
  fhir:StructureMap.jurisdiction [
     fhir:index 0;
     fhir:CodeableConcept.coding [
       fhir:index 0;
       fhir:Coding.system [ fhir:value "http://unstats.un.org/unsd/methods/m49/m49.htm" ];
       fhir:Coding.code [ fhir:value "001" ]
     ]
  ];
  fhir:StructureMap.structure [
     fhir:index 0;
     fhir:StructureMap.structure.url [
       fhir:value "http://hl7.org/fhir/StructureDefinition/Bundle";
       fhir:link <http://hl7.org/fhir/StructureDefinition/Bundle>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "source" ];
     fhir:StructureMap.structure.alias [ fhir:value "Bundle" ]
  ], [
     fhir:index 1;
     fhir:StructureMap.structure.url [
       fhir:value "http://hl7.org/fhir/StructureDefinition/HumanName";
       fhir:link <http://hl7.org/fhir/StructureDefinition/HumanName>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "produced" ];
     fhir:StructureMap.structure.alias [ fhir:value "HumanName" ]
  ], [
     fhir:index 2;
     fhir:StructureMap.structure.url [
       fhir:value "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCPatient";
       fhir:link <http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCPatient>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "source" ];
     fhir:StructureMap.structure.alias [ fhir:value "DDCCPatient" ]
  ], [
     fhir:index 3;
     fhir:StructureMap.structure.url [
       fhir:value "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunization";
       fhir:link <http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunization>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "source" ];
     fhir:StructureMap.structure.alias [ fhir:value "DDCCImmunization" ]
  ], [
     fhir:index 4;
     fhir:StructureMap.structure.url [
       fhir:value "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunizationRecommendation";
       fhir:link <http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunizationRecommendation>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "source" ];
     fhir:StructureMap.structure.alias [ fhir:value "DDCCImmunizationRecommendation" ]
  ], [
     fhir:index 5;
     fhir:StructureMap.structure.url [
       fhir:value "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCComposition";
       fhir:link <http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCComposition>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "source" ];
     fhir:StructureMap.structure.alias [ fhir:value "DDCCComposition" ]
  ], [
     fhir:index 6;
     fhir:StructureMap.structure.url [
       fhir:value "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCoreDataSet.VS.PoV";
       fhir:link <http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCoreDataSet.VS.PoV>
     ];
     fhir:StructureMap.structure.mode [ fhir:value "target" ];
     fhir:StructureMap.structure.alias [ fhir:value "DDCCPoV" ]
  ];
  fhir:StructureMap.group [
     fhir:index 0;
     fhir:StructureMap.group.name [ fhir:value "ResourcesToCoreDataSet" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "bundle" ];
       fhir:StructureMap.group.input.type [ fhir:value "Bundle" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "ddcc" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCPoV" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "setup ddcc" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "bundle" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "vaccination" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "vaccination" ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "certificate" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "certificate" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set hcid" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "bundle" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "link" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "link" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "certificate" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "hcid" ];
           fhir:StructureMap.group.rule.target.variable [ fhir:value "hcid" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set hcid value" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "link" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "url" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "url" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "hcid" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "value" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "evaluate" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueString [ fhir:value "url.replaceMatches('[Uu][Rr][Nn]:[Hh][Cc][Ii][Dd]:', '')" ]
             ]
           ];
           fhir:StructureMap.group.rule.documentation [ fhir:value "There's got to be a better way to do this" ]
         ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.name [ fhir:value "set ddcc id value" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "bundle" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "id" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "id" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "certificate" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "ddccid" ];
           fhir:StructureMap.group.rule.target.variable [ fhir:value "ddccid" ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.target.context [ fhir:value "ddccid" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "value" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "id" ]
           ]
         ]
       ], [
         fhir:index 2;
         fhir:StructureMap.group.rule.name [ fhir:value "set header from patient" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "bundle" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "entry" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "entry" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set patient details" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "entry" ];
             fhir:StructureMap.group.rule.source.type [ fhir:value "Patient" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "resource" ];
             fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "patient" ]
           ];
           fhir:StructureMap.group.rule.dependent [
             fhir:index 0;
             fhir:StructureMap.group.rule.dependent.name [ fhir:value "PatientToDDCCVS" ];
             fhir:StructureMap.group.rule.dependent.variable [
               fhir:value "patient";
               fhir:index 0
             ], [
               fhir:value "ddcc";
               fhir:index 1
             ]
           ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.name [ fhir:value "set immunization" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "entry" ];
             fhir:StructureMap.group.rule.source.type [ fhir:value "Immunization" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "resource" ];
             fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "immunization" ]
           ];
           fhir:StructureMap.group.rule.dependent [
             fhir:index 0;
             fhir:StructureMap.group.rule.dependent.name [ fhir:value "ImmunizationToDDCCVS" ];
             fhir:StructureMap.group.rule.dependent.variable [
               fhir:value "immunization";
               fhir:index 0
             ], [
               fhir:value "vaccination";
               fhir:index 1
             ], [
               fhir:value "certificate";
               fhir:index 2
             ]
           ]
         ], [
           fhir:index 2;
           fhir:StructureMap.group.rule.name [ fhir:value "set immunization recommendation" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "entry" ];
             fhir:StructureMap.group.rule.source.type [ fhir:value "ImmunizationRecommendation" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "resource" ];
             fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "immRec" ]
           ];
           fhir:StructureMap.group.rule.dependent [
             fhir:index 0;
             fhir:StructureMap.group.rule.dependent.name [ fhir:value "ImmRecToDDCCVS" ];
             fhir:StructureMap.group.rule.dependent.variable [
               fhir:value "immRec";
               fhir:index 0
             ], [
               fhir:value "vaccination";
               fhir:index 1
             ]
           ]
         ], [
           fhir:index 3;
           fhir:StructureMap.group.rule.name [ fhir:value "set composition" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "entry" ];
             fhir:StructureMap.group.rule.source.type [ fhir:value "Composition" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "resource" ];
             fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "composition" ]
           ];
           fhir:StructureMap.group.rule.dependent [
             fhir:index 0;
             fhir:StructureMap.group.rule.dependent.name [ fhir:value "CompositionToDDCCVS" ];
             fhir:StructureMap.group.rule.dependent.variable [
               fhir:value "composition";
               fhir:index 0
             ], [
               fhir:value "certificate";
               fhir:index 1
             ]
           ]
         ]
       ]
     ]
  ], [
     fhir:index 1;
     fhir:StructureMap.group.name [ fhir:value "CompositionToDDCCVS" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "composition" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCComposition" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "certificate" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "set version" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "composition" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "certificate" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "version" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueString [ fhir:value "RC2" ]
         ]
       ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.rule.name [ fhir:value "set certificate period" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "composition" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "event" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "event" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set period" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "event" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "period" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "period" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "certificate" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "period" ];
           fhir:StructureMap.group.rule.target.variable [ fhir:value "tPeriod" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set period start" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "period" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "start" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "start" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "tPeriod" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "start" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "start" ]
             ]
           ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.name [ fhir:value "set period end" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "period" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "end" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "end" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "tPeriod" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "end" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "end" ]
             ]
           ]
         ]
       ]
     ]
  ], [
     fhir:index 2;
     fhir:StructureMap.group.name [ fhir:value "PatientToDDCCVS" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "patient" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCPatient" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "ddcc" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCPoV" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "set name" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "patient" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "name" ]
       ];
       fhir:StructureMap.group.rule.dependent [
         fhir:index 0;
         fhir:StructureMap.group.rule.dependent.name [ fhir:value "NameToText" ];
         fhir:StructureMap.group.rule.dependent.variable [
           fhir:value "name";
           fhir:index 0
         ], [
           fhir:value "ddcc";
           fhir:index 1
         ]
       ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.rule.name [ fhir:value "set birth date" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "patient" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "birthDate" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "bday" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "birthDate" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "bday" ]
         ]
       ]
     ], [
       fhir:index 2;
       fhir:StructureMap.group.rule.name [ fhir:value "set identifier from id" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "patient" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "id" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "id" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "identifier" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "identifier" ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.target.context [ fhir:value "identifier" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "value" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "id" ]
         ]
       ]
     ], [
       fhir:index 3;
       fhir:StructureMap.group.rule.name [ fhir:value "set identifier from identifier" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "patient" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "identifier" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "sId" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "identifier" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "identifier" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set identifier value" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "sId" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "value" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "id" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "identifier" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "value" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "id" ]
           ]
         ]
       ];
       fhir:StructureMap.group.rule.documentation [ fhir:value "this will override what was set from id if it exists" ]
     ], [
       fhir:index 4;
       fhir:StructureMap.group.rule.name [ fhir:value "set sex" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "patient" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "gender" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "gender" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "sex" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "gender" ]
         ]
       ]
     ]
  ], [
     fhir:index 3;
     fhir:StructureMap.group.name [ fhir:value "NameToText" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "name" ];
       fhir:StructureMap.group.input.type [ fhir:value "HumanName" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "ddcc" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "set first name" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "name" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "given" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "given" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "evaluate" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueString [ fhir:value "given.replaceMatches('$', ' ')" ]
         ]
       ];
       fhir:StructureMap.group.rule.documentation [ fhir:value "annoying because append doesn't work until ddcc.name is set" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.rule.name [ fhir:value "set other names" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "name" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "given" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "not_first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "other" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "tName" ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "spaced" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "evaluate" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueString [ fhir:value "other.replaceMatches('$', ' ')" ]
         ]
       ], [
         fhir:index 2;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "append" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "tName" ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "spaced" ]
         ]
       ];
       fhir:StructureMap.group.rule.documentation [ fhir:value "name.given not_first as other -> ddcc.name as tName, ddcc.name = append( tName, other ) \"set other names\";" ]
     ], [
       fhir:index 2;
       fhir:StructureMap.group.rule.name [ fhir:value "add family name" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "name" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "family" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "family" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.variable [ fhir:value "tName" ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "append" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "tName" ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "family" ]
         ]
       ]
     ], [
       fhir:index 3;
       fhir:StructureMap.group.rule.name [ fhir:value "set full name" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "name" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "text" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "text" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "ddcc" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "name" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "text" ]
         ]
       ]
     ]
  ], [
     fhir:index 4;
     fhir:StructureMap.group.name [ fhir:value "ImmunizationToDDCCVS" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "immunization" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCImmunization" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "vaccination" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ], [
       fhir:index 2;
       fhir:StructureMap.group.input.name [ fhir:value "certificate" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "set vaccine code" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "vaccineCode" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "code" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set vaccine" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "code" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "coding" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "coding" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "vaccine" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "coding" ]
           ]
         ]
       ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.rule.name [ fhir:value "set extensions" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "extension" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "ext" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set brand" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "ext" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "brand" ];
           fhir:StructureMap.group.rule.source.condition [ fhir:value "ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineBrand'" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set brand code" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "brand" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "valueCoding" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "coding" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "brand" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "coding" ]
             ]
           ]
         ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.name [ fhir:value "set maholder" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "ext" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "maholder" ];
           fhir:StructureMap.group.rule.source.condition [ fhir:value "ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineMarketAuthorization'" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set maholder code" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "maholder" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "valueCoding" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "coding" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "maholder" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "coding" ]
             ]
           ]
         ]
       ], [
         fhir:index 2;
         fhir:StructureMap.group.rule.name [ fhir:value "set validFrom" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "ext" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "valid" ];
           fhir:StructureMap.group.rule.source.condition [ fhir:value "ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineValidFrom'" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set validFrom date" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "valid" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "valueDateTime" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "date" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "validFrom" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "date" ]
             ]
           ]
         ]
       ], [
         fhir:index 3;
         fhir:StructureMap.group.rule.name [ fhir:value "set country" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "ext" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "country" ];
           fhir:StructureMap.group.rule.source.condition [ fhir:value "ext.url = 'http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCountryOfVaccination'" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set country code" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "country" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "valueCode" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "code" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "country" ];
             fhir:StructureMap.group.rule.target.variable [ fhir:value "vCountry" ]
           ], [
             fhir:index 1;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vCountry" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "system" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueString [ fhir:value "urn:iso:std:iso:3166" ]
             ]
           ], [
             fhir:index 2;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vCountry" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "code" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "code" ]
             ]
           ]
         ]
       ]
     ], [
       fhir:index 2;
       fhir:StructureMap.group.rule.name [ fhir:value "set manufacturer" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "manufacturer" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "manufacturer" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set manufacturer id" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "manufacturer" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "identifier" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "identifier" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "manufacturer" ];
           fhir:StructureMap.group.rule.target.variable [ fhir:value "vMan" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set manufacturer system" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "system" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "system" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vMan" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "system" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "system" ]
             ]
           ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.name [ fhir:value "set manufactutuer code" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "value" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "value" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vMan" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "code" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "value" ]
             ]
           ]
         ]
       ]
     ], [
       fhir:index 3;
       fhir:StructureMap.group.rule.name [ fhir:value "set lot number" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "lotNumber" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "lot" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "lot" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "lot" ]
         ]
       ]
     ], [
       fhir:index 4;
       fhir:StructureMap.group.rule.name [ fhir:value "set date" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "occurrence" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "date" ]
       ];
       fhir:StructureMap.group.rule.target [
         fhir:index 0;
         fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
         fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
         fhir:StructureMap.group.rule.target.element [ fhir:value "date" ];
         fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
         fhir:StructureMap.group.rule.target.parameter [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "date" ]
         ]
       ]
     ], [
       fhir:index 5;
       fhir:StructureMap.group.rule.name [ fhir:value "set protocol applied" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "protocolApplied" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "protocol" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set dose" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "protocol" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "doseNumber" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "dose" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "dose" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "dose" ]
           ]
         ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.name [ fhir:value "set totalDoses" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "protocol" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "seriesDoses" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "totalDoses" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "totalDoses" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "totalDoses" ]
           ]
         ]
       ], [
         fhir:index 2;
         fhir:StructureMap.group.rule.name [ fhir:value "set disease" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "protocol" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "targetDisease" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "disease" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set disease coding" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "disease" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "coding" ];
             fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "coding" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "disease" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "coding" ]
             ]
           ]
         ]
       ], [
         fhir:index 3;
         fhir:StructureMap.group.rule.name [ fhir:value "set issuer" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "protocol" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "authority" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "authority" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "certificate" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "issuer" ];
           fhir:StructureMap.group.rule.target.variable [ fhir:value "issuer" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set issuer from reference" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "authority" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "reference" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "reference" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "issuer" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.target.variable [ fhir:value "identifier" ]
           ];
           fhir:StructureMap.group.rule.rule [
             fhir:index 0;
             fhir:StructureMap.group.rule.name [ fhir:value "set reference" ];
             fhir:StructureMap.group.rule.source [
               fhir:index 0;
               fhir:StructureMap.group.rule.source.context [ fhir:value "reference" ]
             ];
             fhir:StructureMap.group.rule.target [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.context [ fhir:value "identifier" ];
               fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
               fhir:StructureMap.group.rule.target.element [ fhir:value "value" ];
               fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
               fhir:StructureMap.group.rule.target.parameter [
                 fhir:index 0;
                 fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "reference" ]
               ]
             ]
           ]
         ], [
           fhir:index 1;
           fhir:StructureMap.group.rule.name [ fhir:value "set issuer identifier" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "authority" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "identifier" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "issuer" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "identifier" ]
             ]
           ]
         ]
       ]
     ], [
       fhir:index 6;
       fhir:StructureMap.group.rule.name [ fhir:value "set vaccination centre location" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "location" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "location" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set vaccination centre from reference" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "location" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "reference" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "reference" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "centre" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "reference" ]
           ]
         ]
       ], [
         fhir:index 1;
         fhir:StructureMap.group.rule.name [ fhir:value "set vaccination centre" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "location" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "display" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "centre" ]
         ];
         fhir:StructureMap.group.rule.target [
           fhir:index 0;
           fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
           fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
           fhir:StructureMap.group.rule.target.element [ fhir:value "centre" ];
           fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
           fhir:StructureMap.group.rule.target.parameter [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "centre" ]
           ]
         ]
       ]
     ], [
       fhir:index 7;
       fhir:StructureMap.group.rule.name [ fhir:value "set performer" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immunization" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "performer" ];
         fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "performer" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "set actor" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "performer" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "actor" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "actor" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set practitioner" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "actor" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "identifier" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "identifier" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "practitioner" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "identifier" ]
             ]
           ]
         ]
       ]
     ]
  ], [
     fhir:index 5;
     fhir:StructureMap.group.name [ fhir:value "ImmRecToDDCCVS" ];
     fhir:StructureMap.group.typeMode [ fhir:value "none" ];
     fhir:StructureMap.group.input [
       fhir:index 0;
       fhir:StructureMap.group.input.name [ fhir:value "immRec" ];
       fhir:StructureMap.group.input.type [ fhir:value "DDCCImmunizationRecommendation" ];
       fhir:StructureMap.group.input.mode [ fhir:value "source" ]
     ], [
       fhir:index 1;
       fhir:StructureMap.group.input.name [ fhir:value "vaccination" ];
       fhir:StructureMap.group.input.mode [ fhir:value "target" ]
     ];
     fhir:StructureMap.group.rule [
       fhir:index 0;
       fhir:StructureMap.group.rule.name [ fhir:value "get recommendation" ];
       fhir:StructureMap.group.rule.source [
         fhir:index 0;
         fhir:StructureMap.group.rule.source.context [ fhir:value "immRec" ];
         fhir:StructureMap.group.rule.source.element [ fhir:value "recommendation" ];
         fhir:StructureMap.group.rule.source.variable [ fhir:value "rec" ]
       ];
       fhir:StructureMap.group.rule.rule [
         fhir:index 0;
         fhir:StructureMap.group.rule.name [ fhir:value "get date criterion" ];
         fhir:StructureMap.group.rule.source [
           fhir:index 0;
           fhir:StructureMap.group.rule.source.context [ fhir:value "rec" ];
           fhir:StructureMap.group.rule.source.element [ fhir:value "dateCriterion" ];
           fhir:StructureMap.group.rule.source.listMode [ fhir:value "first" ];
           fhir:StructureMap.group.rule.source.variable [ fhir:value "due_date" ]
         ];
         fhir:StructureMap.group.rule.rule [
           fhir:index 0;
           fhir:StructureMap.group.rule.name [ fhir:value "set due date" ];
           fhir:StructureMap.group.rule.source [
             fhir:index 0;
             fhir:StructureMap.group.rule.source.context [ fhir:value "due_date" ];
             fhir:StructureMap.group.rule.source.element [ fhir:value "value" ];
             fhir:StructureMap.group.rule.source.variable [ fhir:value "date" ]
           ];
           fhir:StructureMap.group.rule.target [
             fhir:index 0;
             fhir:StructureMap.group.rule.target.context [ fhir:value "vaccination" ];
             fhir:StructureMap.group.rule.target.contextType [ fhir:value "variable" ];
             fhir:StructureMap.group.rule.target.element [ fhir:value "nextDose" ];
             fhir:StructureMap.group.rule.target.transform [ fhir:value "copy" ];
             fhir:StructureMap.group.rule.target.parameter [
               fhir:index 0;
               fhir:StructureMap.group.rule.target.parameter.valueId [ fhir:value "date" ]
             ]
           ]
         ]
       ]
     ]
  ] .

# - ontology header ------------------------------------------------------------

<http://worldhealthorganization.github.io/ddcc/StructureMap/ResourcesToCoreDataSet.ttl> a owl:Ontology;
  owl:imports fhir:fhir.ttl .

# -------------------------------------------------------------------------------------

