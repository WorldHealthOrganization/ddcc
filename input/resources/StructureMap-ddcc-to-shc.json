{
  "resourceType": "StructureMap",
  "id": "ddcc-to-shc",
  "meta": {
    "versionId": "6",
    "lastUpdated": "2021-12-14T21:52:30.434+00:00"
  },
  "text": {
    "status": "generated",
    "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><pre>map &quot;http://worldhealthorganization.github.io/ddcc/StructureMap/ddcc-to-shc&quot; = &quot;DDCCtoSHC&quot;\r\n\r\n\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCDocument&quot; alias DDCCDocument as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCPatient&quot; alias DDCCPatient as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCComposition&quot; alias DDCCComposition as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCOrganization&quot; alias DDCCOrganization as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCountryOfVaccination&quot; alias DDCCCountryOfVaccination as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineBrand&quot; alias DDCCVaccineBrand as source\r\nuses &quot;http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunization&quot; alias DDCCImmunization as source\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-bundle-dm&quot; alias SHCVaccinationBundleDM as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-bundle-ad&quot; alias SHCVaccinationBundleAD as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-general-dm&quot; alias patientDM as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-general-ad&quot; alias patientAD as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-us-dm&quot; alias patientUSDM as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-us-ad&quot; alias patientUSAD as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-dm&quot; alias immunizationDM as target\r\nuses &quot;http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-ad&quot; alias immunizationAD as target\r\n\r\ngroup DDCCtoSHC(source ddcc : DDCCDocument, target shc : SHCVaccinationBundleDM) {\r\n  ddcc.entry as entry then {\r\n    entry.resource : Patient first as patient then {\r\n      entry -&gt; shc.entry as entrySHC then {\r\n        entry.fullUrl -&gt; entrySHC.fullUrl = 'resource:0' &quot;Full URL&quot;;\r\n        patient -&gt; entrySHC.resource = create('Patient') as patientSHC then DDCCPatienttoSHC(patient, patientSHC) &quot;Patient resource&quot;;\r\n      } &quot;Patient entry&quot;;\r\n    } &quot;Is Patient entry&quot;;\r\n  } &quot;map patients&quot;;\r\n  ddcc.entry as entry then {\r\n    entry.resource : Immunization first as immunization then {\r\n      entry -&gt; shc.entry as entrySHC then {\r\n        entry.fullUrl -&gt; entrySHC.fullUrl = 'resource:1' &quot;Full URL&quot;;\r\n        immunization -&gt; entrySHC.resource = create('Immunization') as immunizationSHC then DDCCImmunizationtoSHC(immunization, immunizationSHC) &quot;Immunization resource&quot;;\r\n      } &quot;Immunization entry&quot;;\r\n    } &quot;Is Immunization entry&quot;;\r\n  } &quot;map immunizations&quot;;\r\n}\r\n\r\ngroup DDCCPatienttoSHC(source patient : DDCCPatient, target patientSHC : patientDM) {\r\n  patient.name only_one as name -&gt; patientSHC.name = name then {\r\n    name.given as givenname -&gt; name.given = givenname &quot;Given Name&quot;;\r\n    name.family as familyname -&gt; name.family = familyname &quot;Family Name&quot;;\r\n  } &quot;Name&quot;;\r\n  patient.birthDate as birthDate -&gt; patientSHC.birthDate = birthDate &quot;Birth Date&quot;;\r\n}\r\n\r\ngroup DDCCImmunizationtoSHC(source immunization : DDCCImmunization, target immunizationSHC : immunizationDM) {\r\n  immunization.status as status -&gt; immunizationSHC.status = status &quot;Status&quot;;\r\n  immunization.patient as patient -&gt; immunizationSHC.patient = create('Reference') as patientRef then {\r\n    patient.reference -&gt; patientRef.reference = 'resource:0' &quot;Patient Reference&quot;;\r\n  };\r\n  immunization.coding as coding -&gt; immunizationSHC.coding as codingSHC then vaccineCode(immunization, immunizationSHC) &quot;vaccineCode&quot;;\r\n  immunization.occurrence as occurrenceDateTime -&gt; immunizationSHC.occurrence = occurrenceDateTime &quot;Occurrence DateTime&quot;;\r\n  immunization.manfacturer as manfacturer -&gt; immunizationSHC.manfacturer = manfacturer &quot;Manufacturer&quot;;\r\n  immunization.lotNumber as lotNumber -&gt; immunizationSHC.lotNumber = lotNumber &quot;Lot Number&quot;;\r\n}\r\n\r\ngroup vaccineCode(source immunization : DDCCImmunization, target immunizationSHC : immunizationDM) {\r\n  immunization.coding as coding -&gt; immunizationSHC.coding = coding &quot;vaccineCode Coding&quot;;\r\n}\r\n\r\n</pre></div>"
  },
  "url": "http://worldhealthorganization.github.io/ddcc/StructureMap/ddcc-to-shc",
  "name": "DDCCtoSHC",
  "structure": [ {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCDocument",
    "mode": "source",
    "alias": "DDCCDocument"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCPatient",
    "mode": "source",
    "alias": "DDCCPatient"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCComposition",
    "mode": "source",
    "alias": "DDCCComposition"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCOrganization",
    "mode": "source",
    "alias": "DDCCOrganization"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCCountryOfVaccination",
    "mode": "source",
    "alias": "DDCCCountryOfVaccination"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCVaccineBrand",
    "mode": "source",
    "alias": "DDCCVaccineBrand"
  }, {
    "url": "http://worldhealthorganization.github.io/ddcc/StructureDefinition/DDCCImmunization",
    "mode": "source",
    "alias": "DDCCImmunization"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-bundle-dm",
    "mode": "target",
    "alias": "SHCVaccinationBundleDM"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-bundle-ad",
    "mode": "target",
    "alias": "SHCVaccinationBundleAD"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-general-dm",
    "mode": "target",
    "alias": "patientDM"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-general-ad",
    "mode": "target",
    "alias": "patientAD"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-us-dm",
    "mode": "target",
    "alias": "patientUSDM"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-patient-us-ad",
    "mode": "target",
    "alias": "patientUSAD"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-dm",
    "mode": "target",
    "alias": "immunizationDM"
  }, {
    "url": "http://hl7.org/fhir/uv/shc-vaccination/StructureDefinition/shc-vaccination-ad",
    "mode": "target",
    "alias": "immunizationAD"
  } ],
  "group": [ {
    "name": "DDCCtoSHC",
    "typeMode": "none",
    "input": [ {
      "name": "ddcc",
      "type": "DDCCDocument",
      "mode": "source"
    }, {
      "name": "shc",
      "type": "SHCVaccinationBundleDM",
      "mode": "target"
    } ],
    "rule": [ {
      "name": "map patients",
      "source": [ {
        "context": "ddcc",
        "element": "entry",
        "variable": "entry"
      } ],
      "rule": [ {
        "name": "Is Patient entry",
        "source": [ {
          "context": "entry",
          "type": "Patient",
          "element": "resource",
          "listMode": "first",
          "variable": "patient"
        } ],
        "rule": [ {
          "name": "Patient entry",
          "source": [ {
            "context": "entry"
          } ],
          "target": [ {
            "context": "shc",
            "contextType": "variable",
            "element": "entry",
            "variable": "entrySHC"
          } ],
          "rule": [ {
            "name": "Full URL",
            "source": [ {
              "context": "entry",
              "element": "fullUrl"
            } ],
            "target": [ {
              "context": "entrySHC",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "copy",
              "parameter": [ {
                "valueString": "resource:0"
              } ]
            } ]
          }, {
            "name": "Patient resource",
            "source": [ {
              "context": "patient"
            } ],
            "target": [ {
              "context": "entrySHC",
              "contextType": "variable",
              "element": "resource",
              "variable": "patientSHC",
              "transform": "create",
              "parameter": [ {
                "valueString": "Patient"
              } ]
            } ],
            "dependent": [ {
              "name": "DDCCPatienttoSHC",
              "variable": [ "patient", "patientSHC" ]
            } ]
          } ]
        } ]
      } ]
    }, {
      "name": "map immunizations",
      "source": [ {
        "context": "ddcc",
        "element": "entry",
        "variable": "entry"
      } ],
      "rule": [ {
        "name": "Is Immunization entry",
        "source": [ {
          "context": "entry",
          "type": "Immunization",
          "element": "resource",
          "listMode": "first",
          "variable": "immunization"
        } ],
        "rule": [ {
          "name": "Immunization entry",
          "source": [ {
            "context": "entry"
          } ],
          "target": [ {
            "context": "shc",
            "contextType": "variable",
            "element": "entry",
            "variable": "entrySHC"
          } ],
          "rule": [ {
            "name": "Full URL",
            "source": [ {
              "context": "entry",
              "element": "fullUrl"
            } ],
            "target": [ {
              "context": "entrySHC",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "copy",
              "parameter": [ {
                "valueString": "resource:1"
              } ]
            } ]
          }, {
            "name": "Immunization resource",
            "source": [ {
              "context": "immunization"
            } ],
            "target": [ {
              "context": "entrySHC",
              "contextType": "variable",
              "element": "resource",
              "variable": "immunizationSHC",
              "transform": "create",
              "parameter": [ {
                "valueString": "Immunization"
              } ]
            } ],
            "dependent": [ {
              "name": "DDCCImmunizationtoSHC",
              "variable": [ "immunization", "immunizationSHC" ]
            } ]
          } ]
        } ]
      } ]
    } ]
  }, {
    "name": "DDCCPatienttoSHC",
    "typeMode": "none",
    "input": [ {
      "name": "patient",
      "type": "DDCCPatient",
      "mode": "source"
    }, {
      "name": "patientSHC",
      "type": "patientDM",
      "mode": "target"
    } ],
    "rule": [ {
      "name": "Name",
      "source": [ {
        "context": "patient",
        "element": "name",
        "listMode": "only_one",
        "variable": "name"
      } ],
      "target": [ {
        "context": "patientSHC",
        "contextType": "variable",
        "element": "name",
        "transform": "copy",
        "parameter": [ {
          "valueId": "name"
        } ]
      } ],
      "rule": [ {
        "name": "Given Name",
        "source": [ {
          "context": "name",
          "element": "given",
          "variable": "givenname"
        } ],
        "target": [ {
          "context": "name",
          "contextType": "variable",
          "element": "given",
          "transform": "copy",
          "parameter": [ {
            "valueId": "givenname"
          } ]
        } ]
      }, {
        "name": "Family Name",
        "source": [ {
          "context": "name",
          "element": "family",
          "variable": "familyname"
        } ],
        "target": [ {
          "context": "name",
          "contextType": "variable",
          "element": "family",
          "transform": "copy",
          "parameter": [ {
            "valueId": "familyname"
          } ]
        } ]
      } ]
    }, {
      "name": "Birth Date",
      "source": [ {
        "context": "patient",
        "element": "birthDate",
        "variable": "birthDate"
      } ],
      "target": [ {
        "context": "patientSHC",
        "contextType": "variable",
        "element": "birthDate",
        "transform": "copy",
        "parameter": [ {
          "valueId": "birthDate"
        } ]
      } ]
    } ]
  }, {
    "name": "DDCCImmunizationtoSHC",
    "typeMode": "none",
    "input": [ {
      "name": "immunization",
      "type": "DDCCImmunization",
      "mode": "source"
    }, {
      "name": "immunizationSHC",
      "type": "immunizationDM",
      "mode": "target"
    } ],
    "rule": [ {
      "name": "Status",
      "source": [ {
        "context": "immunization",
        "element": "status",
        "variable": "status"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "status",
        "transform": "copy",
        "parameter": [ {
          "valueId": "status"
        } ]
      } ]
    }, {
      "name": "patient",
      "source": [ {
        "context": "immunization",
        "element": "patient",
        "variable": "patient"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "patient",
        "variable": "patientRef",
        "transform": "create",
        "parameter": [ {
          "valueString": "Reference"
        } ]
      } ],
      "rule": [ {
        "name": "Patient Reference",
        "source": [ {
          "context": "patient",
          "element": "reference"
        } ],
        "target": [ {
          "context": "patientRef",
          "contextType": "variable",
          "element": "reference",
          "transform": "copy",
          "parameter": [ {
            "valueString": "resource:0"
          } ]
        } ]
      } ]
    }, {
      "name": "vaccineCode",
      "source": [ {
        "context": "immunization",
        "element": "coding",
        "variable": "coding"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "coding",
        "variable": "codingSHC"
      } ],
      "dependent": [ {
        "name": "vaccineCode",
        "variable": [ "immunization", "immunizationSHC" ]
      } ]
    }, {
      "name": "Occurrence DateTime",
      "source": [ {
        "context": "immunization",
        "element": "occurrence",
        "variable": "occurrenceDateTime"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "occurrence",
        "transform": "copy",
        "parameter": [ {
          "valueId": "occurrenceDateTime"
        } ]
      } ]
    }, {
      "name": "Manufacturer",
      "source": [ {
        "context": "immunization",
        "element": "manfacturer",
        "variable": "manfacturer"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "manfacturer",
        "transform": "copy",
        "parameter": [ {
          "valueId": "manfacturer"
        } ]
      } ]
    }, {
      "name": "Lot Number",
      "source": [ {
        "context": "immunization",
        "element": "lotNumber",
        "variable": "lotNumber"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "lotNumber",
        "transform": "copy",
        "parameter": [ {
          "valueId": "lotNumber"
        } ]
      } ]
    } ]
  }, {
    "name": "vaccineCode",
    "typeMode": "none",
    "input": [ {
      "name": "immunization",
      "type": "DDCCImmunization",
      "mode": "source"
    }, {
      "name": "immunizationSHC",
      "type": "immunizationDM",
      "mode": "target"
    } ],
    "rule": [ {
      "name": "vaccineCode Coding",
      "source": [ {
        "context": "immunization",
        "element": "coding",
        "variable": "coding"
      } ],
      "target": [ {
        "context": "immunizationSHC",
        "contextType": "variable",
        "element": "coding",
        "transform": "copy",
        "parameter": [ {
          "valueId": "coding"
        } ]
      } ]
    } ]
  } ]
}